<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>刘鹏的小站</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="我想起那天夕阳下的奔跑,那是我逝去的青春">
<meta property="og:type" content="website">
<meta property="og:title" content="刘鹏的小站">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="刘鹏的小站">
<meta property="og:description" content="我想起那天夕阳下的奔跑,那是我逝去的青春">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="刘鹏的小站">
<meta name="twitter:description" content="我想起那天夕阳下的奔跑,那是我逝去的青春">
  
    <link rel="alternative" href="/atom.xml" title="刘鹏的小站" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">刘鹏的小站</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">似水流连</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-vagrant-开发环境配置" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/21/vagrant-开发环境配置/" class="article-date">
  <time datetime="2015-07-21T05:34:35.000Z" itemprop="datePublished">2015-07-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/21/vagrant-开发环境配置/">vagrant 开发环境配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-固定私有IP">1.固定私有IP</h3><p>config.vm.network :private_network, ip: “11.11.11.11”</p>
<h3 id="2-使用自定义用户名">2.使用自定义用户名</h3><p>config.ssh.username = “game1”</p>
<h3 id="3-指定ssh端口">3.指定ssh端口</h3><p>config.ssh.port = “2222”</p>
<h3 id="4-使用private_key_登录">4.使用private key 登录</h3><p>config.ssh.private_key_path = “~/.ssh/id_rsa”</p>
<h1 id="ubuntu操作">ubuntu操作</h1><h3 id="1-创建新用户(useradd会自动创建home/game1目录，并拷贝相关文件)">1.创建新用户(useradd会自动创建home/game1目录，并拷贝相关文件)</h3><p>sudo useradd game1<br>sudo passwd game1</p>
<h3 id="2-创建组">2.创建组</h3><p>sudo groupadd docker</p>
<h3 id="3-添加用户到组">3.添加用户到组</h3><p>sudo usermod -aG docker game1<br>//添加到sudo组，使其可使用sudo命令<br>sudo gpasswd -a game1 sudo</p>
<h3 id="4-取消game1执行sudo命令需要输入密码，_方便vagrant系统命令">4.取消game1执行sudo命令需要输入密码， 方便vagrant系统命令</h3><p>vim /etc/sudoers.d/vagrant</p>
<p>game1 ALL=(ALL) NOPASSWD:ALL</p>
<h3 id="5-添加ssh公钥到主机">5.添加ssh公钥到主机</h3><p>mkdir ~/.ssh<br>vim ~/.ssh/authorized_keys<br>写入公钥信息</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/21/vagrant-开发环境配置/" data-id="cickvtj4j000d95z97z3fpw7q" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/21/vagrant-开发环境配置/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vagrant/">vagrant</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-golang-RWMutex" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/17/golang-RWMutex/" class="article-date">
  <time datetime="2015-07-17T11:22:53.000Z" itemprop="datePublished">2015-07-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/17/golang-RWMutex/">golang-RWMutex</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="RWMutex_读写互斥锁">RWMutex 读写互斥锁</h3><p>基本原则:       </p>
<p>1.可以随便读，多个goroutine同时读<br>2.写的时候，啥也不能干，不能读也不能写</p>
<p>RWMutex四个方法:</p>
<p>func(*RWMutex)Lock //写锁定</p>
<p>func(*RWMutex)Unlock //写锁定</p>
<p>func(*RWMutex)RLock //读锁定</p>
<p>func(*RWMutex)RUnlock  //读解锁</p>
<p>一、随便读</p>
<pre><code>package main

import (
    <span class="string">"sync"</span>
    <span class="string">"time"</span>
)

var m *sync.RWMutex

func main() {
    m = <span class="built_in">new</span>(sync.RWMutex)

   <span class="comment"> //多个同时读</span>
    go <span class="built_in">read</span>(<span class="number">1</span>)
    go <span class="built_in">read</span>(<span class="number">2</span>)

    <span class="built_in">time</span>.Sleep(<span class="number">2</span>*<span class="built_in">time</span>.Second)
}

func <span class="built_in">read</span>(i int) {
    println(i, <span class="string">"read start"</span>)

    m.RLock()
    println(i, <span class="string">"reading"</span>)
    <span class="built_in">time</span>.Sleep(<span class="number">1</span>*<span class="built_in">time</span>.Second)
    m.RUnlock()

    println(i,<span class="string">"read over"</span>)
}

<span class="built_in">result</span>:

<span class="number">1</span> <span class="built_in">read</span> <span class="built_in">start</span>
<span class="number">1</span> reading
<span class="number">2</span> <span class="built_in">read</span> <span class="built_in">start</span>
<span class="number">2</span> reading
<span class="number">1</span> <span class="built_in">read</span> over
<span class="number">2</span> <span class="built_in">read</span> over
</code></pre><p>二、写的时候啥也不能干</p>
<pre><code>package main

<span class="built_in">import</span> <span class="params">(
    <span class="string">"sync"</span>
    <span class="string">"time"</span>
)</span>

var m <span class="built_in">*</span>sync.RWMutex

func main<span class="params">()</span> {
    m = new<span class="params">(sync.RWMutex)</span>

    <span class="comment">// 写的时候啥也不能干</span>
    go write<span class="params">(<span class="number">1</span>)</span>
    go read<span class="params">(<span class="number">2</span>)</span>
    go write<span class="params">(<span class="number">3</span>)</span>

    time.Sleep<span class="params">(<span class="number">2</span>*time.Second)</span>
}

func read<span class="params">(i int)</span> {
    println<span class="params">(i, <span class="string">"read start"</span>)</span>

    m.RLock<span class="params">()</span>
    println<span class="params">(i, <span class="string">"reading"</span>)</span>
    time.Sleep<span class="params">(<span class="number">1</span>*time.Second)</span>
    m.RUnlock<span class="params">()</span>

    println<span class="params">(i, <span class="string">"read over"</span>)</span>
}

func write<span class="params">(i int)</span> {
    println<span class="params">(i, <span class="string">"write start"</span>)</span>

    m.Lock<span class="params">()</span>
    println<span class="params">(i, <span class="string">"writing"</span>)</span>
    time.Sleep<span class="params">(<span class="number">1</span>*time.Second)</span>
    m.Unlock<span class="params">()</span>

    println<span class="params">(i, <span class="string">"write over"</span>)</span>
}

result:

<span class="number">1</span> write start
<span class="number">1</span> writing
<span class="number">2</span> read start
<span class="number">3</span> write start
<span class="number">1</span> writing over
<span class="number">2</span> reading
<span class="number">2</span> read over
<span class="number">3</span> writing
<span class="number">3</span> writing over
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/17/golang-RWMutex/" data-id="cickvtj6b001l95z962kvxe83" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/17/golang-RWMutex/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-upstart-命令备忘" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/14/upstart-命令备忘/" class="article-date">
  <time datetime="2015-07-14T11:47:03.000Z" itemprop="datePublished">2015-07-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/14/upstart-命令备忘/">upstart-命令备忘</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="upstart_script_关键字:">upstart script 关键字:</h3><pre><code><span class="number">1.</span> exec: 执行命令, 在script块中使用
    exec /usr/bin/zip -v

<span class="number">2.</span> script: 脚本块，包括主运行脚本
       script
           exec /usr/bin/zip /root/upstart.zip /root/upstart/txt
       <span class="function"><span class="keyword">end</span> <span class="title">script</span></span>

<span class="number">3.</span> pre-<span class="built_in">start</span>: 脚本块, 在主运行脚本之前执行的脚本
    pre-<span class="built_in">start</span> script
        exec rm /root/upstart.txt
        exec echo pre-<span class="built_in">start</span> &gt;&gt; /root/upstart.txt
    <span class="function"><span class="keyword">end</span> <span class="title">script</span></span>

<span class="number">4.</span> <span class="built_in">post</span>-<span class="built_in">start</span>: 脚本块, 在主运行脚本之后, running状态之前
    <span class="built_in">post</span>-<span class="built_in">start</span> script
        exec echo <span class="built_in">post</span>-<span class="built_in">start</span>&gt;&gt; /root/upstart.txt
    <span class="function"><span class="keyword">end</span> <span class="title">script</span></span>

<span class="number">5.</span> pre-<span class="built_in">stop</span>: 脚本块, 在执行<span class="built_in">stop</span>之前
    pre-<span class="built_in">stop</span> script
        exec echo pre-<span class="built_in">stop</span> &gt;&gt; /root/upstart.txt
    <span class="function"><span class="keyword">end</span> <span class="title">script</span></span>

<span class="number">6.</span> <span class="built_in">post</span>-<span class="built_in">stop</span>: 脚本块, 在主运行脚本被杀死之后
    <span class="built_in">post</span>-<span class="built_in">stop</span> script
        exex echo <span class="built_in">post</span>-<span class="built_in">stop</span> &gt;&gt; /root/upstart.txt
    <span class="function"><span class="keyword">end</span> <span class="title">script</span></span>

<span class="number">7.</span> <span class="built_in">start</span> <span class="command"><span class="keyword">on</span>: 事件, 启动任务</span>
    <span class="built_in">start</span> <span class="command"><span class="keyword">on</span> <span class="title">startup</span></span>

<span class="number">8.</span> <span class="built_in">stop</span> <span class="command"><span class="keyword">on</span>: 事件, 停止任务</span>
    <span class="built_in">stop</span> <span class="command"><span class="keyword">on</span> <span class="title">shutdown</span></span>

<span class="number">9.</span> description: 描述, 信息提示
    desription <span class="string">"This is a upstart testing"</span>

<span class="number">10.</span> author: 描述, 作者信息
    author <span class="string">"liupeng &lt;pengswift.github.io&gt;"</span>

<span class="number">11.</span> <span class="built_in">version</span>: 描述, 版本信息
    <span class="built_in">version</span> <span class="string">"0.0.1 dev"</span>

<span class="number">12.</span> respawn: 命令, 设置服务异常停止后自动重启
    respawn

<span class="number">13.</span> respawn limit: 命令, 设置服务异常停止后重启次数及间隔时间
    respawn limit <span class="number">15</span> <span class="number">3</span>

<span class="number">14.</span> instance: 定义实例名字, 可以通过命令給任务传参数
    instance $TTY
    exec /sbin/getty -<span class="number">8</span> <span class="number">38300</span> $TTY

    <span class="comment">#通过命令传参数</span>
    ~ <span class="built_in">start</span> mytest $TTY=tty1

<span class="number">15.</span> <span class="built_in">kill</span> timeout: 命令, 在达到指定时间后, 停止应用
    <span class="built_in">kill</span> timeout <span class="number">5</span>

<span class="number">16.</span> <span class="keyword">normal</span> exit: 命令, 正常退出，不会被respawn重启
    <span class="keyword">normal</span> exit <span class="number">0</span> TERM

<span class="number">17.</span> env: 变量, 设置任务的环境变量
    env PIDFILE=/var/run/myprocess.pid

<span class="number">18.</span> umask: 变量，设置任务的文件权限掩码
    umask <span class="number">0755</span>

<span class="number">19.</span> nice: 变量， 设置任务的调度优先级
    nice -<span class="number">5</span>

<span class="number">20.</span> limit: 变量， 设置任务的资源限制
    limit nproc <span class="number">10</span> <span class="number">10</span>

<span class="number">21.</span> chroot: 变量, 设置任务的根目录
    chroot /var/lib/www/jail

<span class="number">22.</span> chdir: 变量, 设置任务的工作目录
    chdir /var/tmp
</code></pre><h3 id="upstart_命令">upstart 命令</h3><pre><code><span class="number">1.</span> 查看版本
    ~ initctl <span class="built_in">version</span>
    init (upstart <span class="number">1.12</span>.1)

<span class="number">2.</span> 查看mytest应用状态
    ~ initctl list | grep mytest

    ~ status mytest

<span class="number">3.</span> 启动mytest应用
    ~ initctl <span class="built_in">start</span> mytest

    ~ <span class="built_in">start</span> mytest

<span class="number">4.</span> 停止mytest应用
    ~ initctl <span class="built_in">stop</span> mytest

    ~ <span class="built_in">stop</span> mytest
</code></pre><h3 id="upstart封装mytest">upstart封装mytest</h3><pre><code>~ vi /etc/init/mytest.conf

description <span class="string">"mytest"</span>
author <span class="string">"bsspirit &lt;http://blog.fens.me&gt;"</span>

env <span class="variable"><span class="keyword">var</span></span>=bar
export <span class="variable"><span class="keyword">var</span>

start on startup
stop on shutdown

respawn
respawn limit 2 5

console output

pre-start script
    logger "pre-start</span>: before: <span class="variable"><span class="keyword">var</span></span>=$<span class="variable"><span class="keyword">var</span>"
    <span class="keyword">var</span></span>=pre-start
    export <span class="variable"><span class="keyword">var</span>
    logger "pre-start</span>: after: <span class="variable"><span class="keyword">var</span></span>=$<span class="variable"><span class="keyword">var</span>"
end script

post-start script
    logger "post-start</span>: before: <span class="variable"><span class="keyword">var</span></span>=$<span class="variable"><span class="keyword">var</span>"
    <span class="keyword">var</span></span>=post-start
    export <span class="variable"><span class="keyword">var</span>
    logger "post-start</span>: after: <span class="variable"><span class="keyword">var</span></span>=$<span class="variable"><span class="keyword">var</span>"
end script

script
    logger "script</span>: before: <span class="variable"><span class="keyword">var</span></span>=$<span class="variable"><span class="keyword">var</span>"
    <span class="keyword">var</span></span>=main
    export <span class="variable"><span class="keyword">var</span>
    sleep 60000
    logger "script</span>: after: <span class="variable"><span class="keyword">var</span></span>=$<span class="variable"><span class="keyword">var</span>"
end script

post-stop script
    logger "post-stop</span>: before: <span class="variable"><span class="keyword">var</span></span>=$<span class="variable"><span class="keyword">var</span>"
    <span class="keyword">var</span></span>=post-stop
    export <span class="variable"><span class="keyword">var</span>
    logger "post-stop</span>: after: <span class="variable"><span class="keyword">var</span></span>=$<span class="variable"><span class="keyword">var</span>"
end script




测试mytest程序</span>:

启动mytest任务
    ~ start mytest
    mytest start/running, process <span class="number">3257</span>

查看日志跟踪运行状态
    ~ tail -f /<span class="variable"><span class="keyword">var</span>/log/syslog

    Jun 14 20</span>:<span class="number">41</span>:<span class="number">13</span> liupeng-VirtualBox logger: pre-start: before: <span class="variable"><span class="keyword">var</span></span>=bar
    Jun <span class="number">14</span> <span class="number">20</span>:<span class="number">41</span>:<span class="number">13</span> liupeng-VirtualBox logger: pre-start: after: <span class="variable"><span class="keyword">var</span></span>=pre-start
    Jun <span class="number">14</span> <span class="number">20</span>:<span class="number">41</span>:<span class="number">13</span> liupeng-VirtualBox logger: script: before: <span class="variable"><span class="keyword">var</span></span>=bar
    Jun <span class="number">14</span> <span class="number">20</span>:<span class="number">41</span>:<span class="number">13</span> liupeng-VirtualBox logger: post-start: before: <span class="variable"><span class="keyword">var</span></span>=bar
    Jun <span class="number">14</span> <span class="number">20</span>:<span class="number">41</span>:<span class="number">13</span> liupeng-VirtualBox logger: post-start: after: <span class="variable"><span class="keyword">var</span></span>=post-start

查看mytest任务状态
    ~ status mytest
    mytest start/running, process <span class="number">3257</span>

查看系统进程，因为在程序中用sleep停止，要通过sleep查询
    ~ ps -aux|grep sleep
    root     <span class="number">3220</span>  <span class="number">0.0</span>  <span class="number">0.0</span>   <span class="number">2176</span>   <span class="number">276</span> ?        S    <span class="number">20</span>:<span class="number">40</span>   <span class="number">0</span>:<span class="number">00</span> sleep <span class="number">60000</span>

杀掉sleep进程，mytest自动重启
    kill -<span class="number">9</span> <span class="number">3220</span>

停止mytest
    stop mytest
    mytest stop/waiting

通过命令传参数，启动mytest
start mytest <span class="variable"><span class="keyword">var</span></span>=liupeng
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/14/upstart-命令备忘/" data-id="cickvtj4m000g95z9928s06jv" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/14/upstart-命令备忘/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker-命令备忘" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/14/docker-命令备忘/" class="article-date">
  <time datetime="2015-07-14T11:00:37.000Z" itemprop="datePublished">2015-07-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/14/docker-命令备忘/">docker-命令备忘</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="docker_命令">docker 命令</h3><pre><code>1. 创建容器
    docker <span class="keyword">run</span> -i -t ubuntu /bin/base

2. 创建并设置容器别名
    docker <span class="keyword">run</span> --name bob_the_container -i -t ubuntu /bin/bash

3. 启动容器
    docker start bob_the_container

    docker start aa3f365f044e


4. 重启容器
    docker restart bob_the_container

5. attach到容器
    docker attach bot_the_container

6. 创建守护式容器
    docker <span class="keyword">run</span> --name daemon_dave -<span class="keyword">d</span> ubuntu /bin/<span class="keyword">sh</span> -c <span class="string">"while true; do echo hello world; sleep 1; done"</span>

7. 查看容器日志
    docker logs daemon_dave

8. 监控容器日志
    docker logs -f daemon_dave
    docker logs --tail 10 daemon_dave
    docker logs --tail 0 -f daemon_dave

9. 查看容器内进程
    docker top daemon_dave


10. 下载镜像
    docker pull ubuntu:latest

11. 查看已下载的镜像
    docker images ubuntu

12. 查找可用的镜像
    docker <span class="keyword">search</span> puppet

13. 创建镜像
    docker commit 4aab3ce3cb76 jamtur01/apache2

14. 创建并添加提交信息 (日志， 作者， tag)
    docker commit -<span class="keyword">m</span>=<span class="string">"A new custom image"</span> --author=<span class="string">"liupeng"</span> 4aab3ce3cb76 jamtur01/apache2:webserver

15. 查看镜像详细信息
    docker <span class="keyword">inspect</span> jamtur01/apache2:webserver

16. 通过Dockerfile 创建镜像
    ＃ <span class="keyword">Version</span>: 0.0.1
    FROM ubuntu:14.04
    MAINTRAINER liupeng <span class="string">"pengswift.github.io"</span>
    <span class="keyword">RUN</span> apt-get <span class="keyword">update</span>
    <span class="keyword">RUN</span> <span class="keyword">ap</span>-get install -y nginx
    <span class="keyword">RUN</span> echo <span class="string">"Hi, I am in your container"</span>
        &gt;/usr/share/nginx/html/index.html
    EXPOSE 80

    通过本地Dockerfile
    docker build -t=<span class="string">"jamtur01/static_web:v1"</span> .

    通过git仓库
    docker build -t=<span class="string">"jamtur01/static_web:v1"</span> git@github.com:jamtur01/docker-static_web

17. 不使用缓存创建镜像
    docker build --<span class="keyword">no</span>-cache -t=<span class="string">"jamtur01/static_web"</span>        
18. 查看镜像的创建历史
    docker history training/postgres

19. 启动容器，指定容器端口
    docker <span class="keyword">run</span> -<span class="keyword">d</span> -p 80 --name static_web jamtur01/static_web nginx -<span class="keyword">g</span> <span class="string">"daemon off;"</span>

20. 查看容器端口在宿主上的映射端口
    docker port 6752b94bb5c0 80

21. 启动容器，指定宿主和容器端口
    docker <span class="keyword">run</span> -<span class="keyword">d</span> -p 8080:80 --name static_web jamtur01/static_web nginx -<span class="keyword">g</span> <span class="string">"daemon off;"</span>

22. 启动容器，指定宿主和容器端口, 限制ip访问
    docker <span class="keyword">run</span> -<span class="keyword">d</span> -p 127.0.0.1:8080:80 --name static_web jamtur01/static_web nginx -<span class="keyword">g</span> <span class="string">"daemon off;"</span>

23. 启动容器，使用Dockerfile 默认端口
    docker <span class="keyword">run</span> -<span class="keyword">d</span> -P --name static_web jamtur01/static_web nginx -<span class="keyword">g</span> <span class="string">"daemon off;"</span>
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/14/docker-命令备忘/" data-id="cickvtj36000095z92zz1542m" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/14/docker-命令备忘/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-golang-单向channel" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/golang-单向channel/" class="article-date">
  <time datetime="2015-07-07T15:18:42.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/golang-单向channel/">golang-单向channel</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>e.g.</p>
<pre><code><span class="keyword">package</span> main

<span class="keyword">func</span> main() {
    c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="typename">int</span>, <span class="number">3</span>)

    <span class="keyword">var</span> send <span class="keyword">chan</span>&lt;- <span class="typename">int</span> = c
    <span class="keyword">var</span> recv &lt;-<span class="keyword">chan</span> <span class="typename">int</span> = c

    send &lt;- <span class="number">1</span>

    <span class="built_in">println</span>(&lt;-recv)

}
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/07/golang-单向channel/" data-id="cickvtj5p001595z9aixht9m9" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/07/golang-单向channel/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-golang-map遍历key随机" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/golang-map遍历key随机/" class="article-date">
  <time datetime="2015-07-07T11:55:42.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/golang-map遍历key随机/">golang-map遍历key随机</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>e.g. </p>
<pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
)

<span class="keyword">func</span> main() {
    m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="typename">string</span>]<span class="typename">string</span>)
    m[<span class="string">"hello"</span>] = <span class="string">"echo hello"</span>
    m[<span class="string">"world"</span>] = <span class="string">"echo world"</span>
    m[<span class="string">"go"</span>] = <span class="string">"echo go"</span>
    m[<span class="string">"is"</span>] = <span class="string">"echo is"</span>
    m[<span class="string">"cool"</span>] = <span class="string">"echo cool"</span>

    <span class="keyword">for</span> k, v := <span class="keyword">range</span> m {
        fmt.Printf(<span class="string">"k=%v, v=%v\n"</span>, k, v)
    }
}
</code></pre><p>修正版</p>
<p>e.g.</p>
<pre><code><span class="keyword">package</span> main

<span class="keyword">import</span> (
    <span class="string">"fmt"</span>
    <span class="string">"sort"</span>
)

<span class="keyword">func</span> main() {
    m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="typename">string</span>]<span class="typename">string</span>)
    m[<span class="string">"hello"</span>] = <span class="string">"echo hello"</span>
    m[<span class="string">"world"</span>] = <span class="string">"echo world"</span>
    m[<span class="string">"go"</span>] = <span class="string">"echo go"</span>
    m[<span class="string">"is"</span>] = <span class="string">"echo is"</span>
    m[<span class="string">"cool"</span>] = <span class="string">"echo cool"</span>

    sorted_keys := <span class="built_in">make</span>([]<span class="typename">string</span>, <span class="number">0</span>)
    <span class="keyword">for</span> k, _ := <span class="keyword">range</span> m {
        sorted_keys = <span class="built_in">append</span>(sorted_keys, k)
    }

    sort.Strings(sorted_keys)

    <span class="keyword">for</span> _, k := <span class="keyword">range</span> sorted_keys {
        fmt.Printf(<span class="string">"k=%v, v=%v\n"</span>, k, m[k])
    }
}
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/07/golang-map遍历key随机/" data-id="cickvtj69001j95z95l49umeb" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/07/golang-map遍历key随机/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-golang-Benchmark" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/golang-Benchmark/" class="article-date">
  <time datetime="2015-07-07T10:15:48.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/golang-Benchmark/">golang-Benchmark</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>e.g.</p>
<pre><code>package my

<span class="keyword">import</span>(
    <span class="string">"sync"</span>
    <span class="string">"testing"</span>
)

<span class="keyword">var</span> lock sync.<span class="type">Mutex</span>

<span class="func"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> {
    lock.<span class="type">Lock</span>()
    lock.<span class="type">Unlock</span>()
}

<span class="func"><span class="keyword">func</span> <span class="title">testdefer</span><span class="params">()</span></span> {
    lock.<span class="type">Lock</span>()
    defer lock.<span class="type">Unlock</span>()
}

<span class="func"><span class="keyword">func</span> <span class="title">BenchmarkTest</span><span class="params">(b *testing.B)</span></span> {
    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.<span class="type">N</span>; i++ {
        test()
    }
}

<span class="func"><span class="keyword">func</span> <span class="title">BenchmarkTestDefer</span><span class="params">(b *testing.B)</span></span> {
    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.<span class="type">N</span>; i++ {
        testdefer()
    }
}
</code></pre><p>命令:<br>go test defer_b_test.go -bench=”.*”</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/07/golang-Benchmark/" data-id="cickvtj6e001n95z9v60y405x" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/07/golang-Benchmark/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-golang-返回-int指针" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/golang-返回-int指针/" class="article-date">
  <time datetime="2015-07-07T08:46:36.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/golang-返回-int指针/">golang-返回*int指针</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>func test() *int {<br>    x := 100<br>    return &amp;x<br>}</p>
<p>注: 此处因为返回了变量int的地址， 所以基本类型x的值不会分配到栈中，<br>    因为栈中的数据只在作用域范围内有效。<br>    所以此处编译器会根据需求将其分配到堆中，交给gc去处理</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/07/golang-返回-int指针/" data-id="cickvtj5m001295z9g3vn34uz" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/07/golang-返回-int指针/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-golang-16进制-2进制" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/golang-16进制-2进制/" class="article-date">
  <time datetime="2015-07-07T08:20:51.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/golang-16进制-2进制/">golang-16进制&amp;10进制</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1个字节byte(8位2进制数)<br>        可以用来表示1个10进制数，<br>        可以用来表示2个16进制数（每四位二进制可以表示1个16进制数），</p>
<p>e.g.</p>
<pre><code>package main

<span class="built_in">import</span><span class="params">(
    <span class="string">"fmt"</span>
    <span class="string">"unsafe"</span>
)</span>    

func main<span class="params">()</span> {
    <span class="comment">//声明1个16进制的数</span>
    x := <span class="number">0</span>x12345678

    <span class="comment">//将指向x的指针转变成通用指针</span>
    p := unsafe.Pointer<span class="params">(&amp;x)</span>
    <span class="comment">//将通用指针转变成容量是4 的字节数组的指针, 这样，由于每个字节能存储2个16进制数， 所以 4个字节的容量 可以存储 8个16进制的数</span>
    n :=<span class="params">(*[<span class="number">4</span>]byte)</span><span class="params">(p)</span>

    <span class="comment">//遍历, 每次打印一个字节， （包含2个16进制的数）</span>
    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; len<span class="params">(n)</span>; i++ {
        fmt.Printf<span class="params">(<span class="string">"%X "</span>, n[i])</span>
    }
}
</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/07/golang-16进制-2进制/" data-id="cickvtj6h001p95z9v9qc9yoh" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/2015/07/07/golang-16进制-2进制/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/">golang</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/">golang</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/regex/">regex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vagrant/">vagrant</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/匆匆那年/">匆匆那年</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并发编程/">并发编程</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/golang/" style="font-size: 20px;">golang</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/regex/" style="font-size: 10px;">regex</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/vagrant/" style="font-size: 10px;">vagrant</a> <a href="/tags/匆匆那年/" style="font-size: 10px;">匆匆那年</a> <a href="/tags/并发编程/" style="font-size: 10px;">并发编程</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a><span class="archive-list-count">16</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/07/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2015/07/21/vagrant-开发环境配置/">vagrant 开发环境配置</a>
          </li>
        
          <li>
            <a href="/2015/07/17/golang-RWMutex/">golang-RWMutex</a>
          </li>
        
          <li>
            <a href="/2015/07/14/upstart-命令备忘/">upstart-命令备忘</a>
          </li>
        
          <li>
            <a href="/2015/07/14/docker-命令备忘/">docker-命令备忘</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 刘鹏<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'pengswift';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>
